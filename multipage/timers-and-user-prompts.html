<!DOCTYPE html><html class=split lang=en-US-x-hixie><script src=/html/link-fixup.js defer=""></script><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport><title>HTML Standard</title><meta content=#3c790a name=theme-color><link rel=stylesheet href=https://resources.whatwg.org/spec.css crossorigin=""><link rel=stylesheet href=https://resources.whatwg.org/standard.css crossorigin=""><link rel=stylesheet href=https://resources.whatwg.org/standard-shared-with-dev.css crossorigin=""><link rel=icon href=https://resources.whatwg.org/logo.svg crossorigin=""><link rel=stylesheet href=/html/styles.css crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
   function setLinkFragment(link) {
     link.hash = location.hash;
   }
  </script><link rel=stylesheet href=/html/resources/zh-cn.css><body>
  
  <script async="" crossorigin="" src=/html/resources/html-dfn.js></script>
  <script data-file-issue-url=https://github.com/whatwg/html/issues/new async="" crossorigin="" src=https://resources.whatwg.org/file-issue.js></script>
  
  <header id=head class="head with-buttons">
   <a href=https://whatwg.org/ class=logo><img width=100 alt=WHATWG crossorigin="" src=https://resources.whatwg.org/logo.svg height=100></a>
   <hgroup><h1 class=allcaps>HTML</h1><h2 id=living-standard class="no-num no-toc">Living Standard — Last Updated <span class=pubdate>20 June 2021</span></h2><div data-en-date="Sat Aug 11 2018 08:00:56 GMT+0000 (UTC)" class=translate-info data-zh-date="" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/living-standard-mdash-last-updated-date-01-jan-1901.en.html data-zh-file="https://github.com/whatwg-cn/html/new/master/src/living-standard-mdash-last-updated-date-01-jan-1901.zh.html?filename=living-standard-mdash-last-updated-date-01-jan-1901.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fliving-standard-mdash-last-updated-date-01-jan-1901.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91"></div><div data-en-date="Sat Aug 11 2018 08:00:56 GMT+0000 (UTC)" class=translate-info data-zh-date="" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/commit-snapshot-mdash-last-updated-date-01-jan-1901.en.html data-zh-file="https://github.com/whatwg-cn/html/new/master/src/commit-snapshot-mdash-last-updated-date-01-jan-1901.zh.html?filename=commit-snapshot-mdash-last-updated-date-01-jan-1901.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fcommit-snapshot-mdash-last-updated-date-01-jan-1901.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91"></div><div data-en-date="Sat Aug 11 2018 08:00:56 GMT+0000 (UTC)" class=translate-info data-zh-date="" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/review-draft-mdash-published-date-01-jan-1901.en.html data-zh-file="https://github.com/whatwg-cn/html/new/master/src/review-draft-mdash-published-date-01-jan-1901.zh.html?filename=review-draft-mdash-published-date-01-jan-1901.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Freview-draft-mdash-published-date-01-jan-1901.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91"></div></hgroup>
   
   
   <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-91053840-1', 'auto');
      ga('send', 'pageview');
   </script>
  </header>

  

  


  
<div data-en-date="Thu Mar 01 2018 15:51:30 GMT+0000 (UTC)" class=translate-info data-zh-date="Thu Mar 01 2018 15:51:30 GMT+0000 (UTC)" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/table-of-contents.en.html data-zh-file=https://github.com/whatwg-cn/html/edit/master/src/table-of-contents.zh.html></div>
  


  
<div data-en-date="Sat Aug 11 2018 08:00:56 GMT+0000 (UTC)" class=translate-info data-zh-date="Thu Mar 01 2018 15:51:30 GMT+0000 (UTC)" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/full-table-of-contents.en.html data-zh-file=https://github.com/whatwg-cn/html/edit/master/src/full-table-of-contents.zh.html></div>
  

  

  


  <nav><a href=dynamic-markup-insertion.html>← 8.4 Dynamic markup insertion</a> — <a href=./>Table of Contents</a> — <a href=system-state.html>8.9 System state and capabilities →</a></nav><ol class=toc><li id=toc-webappapis><ol><li><a href=timers-and-user-prompts.html#timers><span class=secno>8.6</span> Timers</a><li><a href=timers-and-user-prompts.html#microtask-queuing><span class=secno>8.7</span> Microtask queuing</a><li><a href=timers-and-user-prompts.html#用户提示><span class=secno>8.8</span> 用户提示</a><ol><li><a href=timers-and-user-prompts.html#simple-dialogs><span class=secno>8.8.1</span> Simple dialogs</a><li><a href=timers-and-user-prompts.html#printing><span class=secno>8.8.2</span> Printing</a></ol></ol></ol><h3 id=timers><span class=secno>8.6</span> Timers<a href=#timers class=self-link></a></h3>
<div data-zh-date="" data-en-date="Wed Nov 04 2020 06:47:17 GMT+0000 (UTC)" class=translate-info data-zh-file="https://github.com/whatwg-cn/html/new/master/src/web-application-apis/timers.zh.html?filename=timers.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fweb-application-apis%2Ftimers.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/web-application-apis/timers.en.html></div>

  <p>The <code id=timers:dom-settimeout><a href=#dom-settimeout>setTimeout()</a></code> and <code id=timers:dom-setinterval><a href=#dom-setinterval>setInterval()</a></code> methods allow authors to schedule timer-based
  callbacks.</p>

  <dl class=domintro><dt><var>handle</var> = self . <code id=dom-settimeout-dev><a href=#dom-settimeout>setTimeout</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout title="The setTimeout() method of the WindowOrWorkerGlobalScope mixin sets a timer which executes a function or specified piece of code once the timer expires.">WindowOrWorkerGlobalScope/setTimeout</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>30+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>30+</span></span><span class="webview_android yes"><span>WebView Android</span><span>4.4+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>3.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Schedules a timeout to run <var>handler</var> after <var>timeout</var>
    milliseconds. Any <var>arguments</var> are passed straight through to the <var>handler</var>.</p>
   <dt><var>handle</var> = self . <code id=timers:dom-settimeout-2><a href=#dom-settimeout>setTimeout</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd>
    <p>Schedules a timeout to compile and run <var>code</var> after <var>timeout</var> milliseconds.</p>
   <dt>self . <code id=dom-cleartimeout-dev><a href=#dom-cleartimeout>clearTimeout</a></code>( <var>handle</var> )<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout title="The clearTimeout() method of the WindowOrWorkerGlobalScope mixin cancels a timeout previously established by calling setTimeout().">WindowOrWorkerGlobalScope/clearTimeout</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>45+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>45+</span></span><span class="webview_android yes"><span>WebView Android</span><span>45+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Cancels the timeout set with <code id=timers:dom-settimeout-3><a href=#dom-settimeout>setTimeout()</a></code> or <code id=timers:dom-setinterval-2><a href=#dom-setinterval>setInterval()</a></code> identified by <var>handle</var>.</p>
   <dt><var>handle</var> = self . <code id=dom-setinterval-dev><a href=#dom-setinterval>setInterval</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval title="The setInterval() method, offered on the Window and Worker interfaces, repeatedly calls a function or executes a code snippet, with a fixed time delay between each call.">WindowOrWorkerGlobalScope/setInterval</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>30+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>30+</span></span><span class="webview_android yes"><span>WebView Android</span><span>4.4+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>3.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Schedules a timeout to run <var>handler</var> every <var>timeout</var>
    milliseconds. Any <var>arguments</var> are passed straight through to the <var>handler</var>.</p>
   <dt><var>handle</var> = self . <code id=timers:dom-setinterval-3><a href=#dom-setinterval>setInterval</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd>
    <p>Schedules a timeout to compile and run <var>code</var> every <var>timeout</var> milliseconds.</p>
   <dt>self . <code id=dom-clearinterval-dev><a href=#dom-clearinterval>clearInterval</a></code>( <var>handle</var> )<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval title="The clearInterval() method of the WindowOrWorkerGlobalScope mixin cancels a timed, repeating action which was previously established by a call to setInterval().">WindowOrWorkerGlobalScope/clearInterval</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Cancels the timeout set with <code id=timers:dom-setinterval-4><a href=#dom-setinterval>setInterval()</a></code> or <code id=timers:dom-settimeout-4><a href=#dom-settimeout>setTimeout()</a></code> identified by <var>handle</var>.</p>
   </dl>

  <p class=note>Timers can be nested; after five such nested timers, however, the interval is
  forced to be at least four milliseconds.</p>

  <p class=note>This API does not guarantee that timers will run exactly on schedule. Delays due
  to CPU load, other tasks, etc, are to be expected.</p>

  

  <p>Objects that implement the <code id=timers:windoworworkerglobalscope><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> mixin have a <dfn id=list-of-active-timers data-export="">list of active timers</dfn>. Each entry in this lists is identified by a number, which must
  be unique within the list for the lifetime of the object that implements the
  <code id=timers:windoworworkerglobalscope-2><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> mixin.</p>

  <hr>

  <p>The <dfn id=dom-settimeout><code id=dom-windowtimers-setTimeout>setTimeout()</code></dfn> method must return the value returned
  by the <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps>timer initialization steps</a>, passing them the method's arguments, the object on
  which the method for which the algorithm is running is implemented (a <code id=timers:window><a href=window-object.html#window>Window</a></code> or
  <code id=timers:workerglobalscope><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var>
  flag set to false.</p>

  <p>The <dfn id=dom-setinterval><code id=dom-windowtimers-setInterval>setInterval()</code></dfn> method must return the value returned
  by the <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps-2>timer initialization steps</a>, passing them the method's arguments, the object on
  which the method for which the algorithm is running is implemented (a <code id=timers:window-2><a href=window-object.html#window>Window</a></code> or
  <code id=timers:workerglobalscope-2><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var>
  flag set to true.</p>

  <p>The <dfn id=dom-cleartimeout><code id=dom-windowtimers-clearTimeout>clearTimeout()</code></dfn> and <dfn id=dom-clearinterval><code id=dom-windowtimers-clearInterval>clearInterval()</code></dfn>
  methods must clear the entry identified as <var>handle</var> from the <a href=#list-of-active-timers id=timers:list-of-active-timers>list of active
  timers</a> of the <code id=timers:windoworworkerglobalscope-3><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> object on which the method was
  invoked, if any, where <var>handle</var> is the argument passed to the method. (If
  <var>handle</var> does not identify an entry in the <a href=#list-of-active-timers id=timers:list-of-active-timers-2>list of active timers</a> of the
  <code id=timers:windoworworkerglobalscope-4><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> object on which the method was invoked, the method does
  nothing.)</p>

  <p class=note>Because <code id=timers:dom-cleartimeout><a href=#dom-cleartimeout>clearTimeout()</a></code> and <code id=timers:dom-clearinterval><a href=#dom-clearinterval>clearInterval()</a></code> clear entries from the same list, either method
  can be used to clear timers created by <code id=timers:dom-settimeout-5><a href=#dom-settimeout>setTimeout()</a></code> or <code id=timers:dom-setinterval-5><a href=#dom-setinterval>setInterval()</a></code>.</p>

  <hr>

  <p>The <dfn id=timer-initialisation-steps>timer initialization steps</dfn>, which
  are invoked with some method arguments, a <var>method context</var>, a <var>repeat</var> flag
  which can be true or false, and optionally (and only if the <var>repeat</var> flag is true) a
  <var>previous handle</var>, are as follows:</p>

  <ol><li><p>Let <var>method context proxy</var> be <var>method context</var> if that
   is a <code id=timers:workerglobalscope-3><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object, or else the <code id=timers:windowproxy><a href=window-object.html#windowproxy>WindowProxy</a></code> that corresponds
   to <var>method context</var>.<li><p>If <var>previous handle</var> was provided, let <var>handle</var> be <var>previous
   handle</var>; otherwise, let <var>handle</var> be an <a id=timers:implementation-defined href=https://infra.spec.whatwg.org/#implementation-defined data-x-internal=implementation-defined>implementation-defined</a> integer
   that is greater than zero that will identify the timeout to be set by this call in the <a href=#list-of-active-timers id=timers:list-of-active-timers-3>list
   of active timers</a>.<li><p>If <var>previous handle</var> was not provided, add an entry to the <a href=#list-of-active-timers id=timers:list-of-active-timers-4>list of
   active timers</a> for <var>handle</var>.<li><p>Let <var>callerRealm</var> be the <a id=timers:current-realm-record href=https://tc39.es/ecma262/#current-realm data-x-internal=current-realm-record>current Realm Record</a>, and
   <var>calleeRealm</var> be <var>method context</var>'s <a id=timers:javascript-realm href=https://tc39.es/ecma262/#sec-code-realms data-x-internal=javascript-realm>JavaScript realm</a>.<li><p>Let <var>initiating script</var> be the <a id=timers:active-script href=webappapis.html#active-script>active script</a>.<li><p>Assert: <var>initiating script</var> is not null, since this algorithm is always called
   from some script.<li>
    <p>Let <var>task</var> be a <a href=webappapis.html#concept-task id=timers:concept-task>task</a> that runs the
    following substeps:</p>

    <ol><li><p>If the entry for <var>handle</var> in the <a href=#list-of-active-timers id=timers:list-of-active-timers-5>list of active timers</a> has been
     cleared, then abort these steps.<li>
      <p>Run the appropriate set of steps from the following list:</p>

      <dl class=switch><dt>If the first method argument is a <code id=timers:idl-function><a data-x-internal=idl-function href=https://heycam.github.io/webidl/#common-Function>Function</a></code><dd><p><a href=https://heycam.github.io/webidl/#invoke-a-callback-function id=timers:es-invoking-callback-functions data-x-internal=es-invoking-callback-functions>Invoke</a> the <code id=timers:idl-function-2><a data-x-internal=idl-function href=https://heycam.github.io/webidl/#common-Function>Function</a></code>. Use the third and subsequent method arguments (if any)
       as the arguments for invoking the <code id=timers:idl-function-3><a data-x-internal=idl-function href=https://heycam.github.io/webidl/#common-Function>Function</a></code>. Use
       <var>method context proxy</var> as the <a href=https://heycam.github.io/webidl/#dfn-callback-this-value id=timers:dfn-callback-this-value data-x-internal=dfn-callback-this-value>callback this
       value</a>. If this throws an exception, catch it, and <a id=timers:report-the-exception href=webappapis.html#report-the-exception>report the
       exception</a>.<dt>Otherwise<dd>
        <ol><li><p>Perform <a href=webappapis.html#hostensurecancompilestrings(callerrealm,-calleerealm) id=timers:hostensurecancompilestrings(callerrealm,-calleerealm)>HostEnsureCanCompileStrings</a>(<var>callerRealm</var>,
         <var>calleeRealm</var>). If this throws an exception, catch it, <a id=timers:report-the-exception-2 href=webappapis.html#report-the-exception>report the
         exception</a>, and abort these steps.<li><p>Let <var>script source</var> be the first method argument.<li><p>Let <var>settings object</var> be <var>method context</var>'s <a id=timers:environment-settings-object href=webappapis.html#environment-settings-object>environment
         settings object</a>.<li><p>Let <var>base URL</var> be <var>initiating script</var>'s <a href=webappapis.html#concept-script-base-url id=timers:concept-script-base-url>base URL</a>.<li>
          <p>Let <var>fetch options</var> be a <a id=timers:script-fetch-options href=webappapis.html#script-fetch-options>script fetch options</a> whose <a href=webappapis.html#concept-script-fetch-options-nonce id=timers:concept-script-fetch-options-nonce>cryptographic nonce</a> is <var>initiating
          script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options>fetch options</a>'s
          <a href=webappapis.html#concept-script-fetch-options-nonce id=timers:concept-script-fetch-options-nonce-2>cryptographic nonce</a>, <a href=webappapis.html#concept-script-fetch-options-integrity id=timers:concept-script-fetch-options-integrity>integrity metadata</a> is the empty
          string, <a href=webappapis.html#concept-script-fetch-options-parser id=timers:concept-script-fetch-options-parser>parser metadata</a> is
          "<code>not-parser-inserted</code>", <a href=webappapis.html#concept-script-fetch-options-credentials id=timers:concept-script-fetch-options-credentials>credentials mode</a> is
          <var>initiating script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options-2>fetch
          options</a>'s <a href=webappapis.html#concept-script-fetch-options-credentials id=timers:concept-script-fetch-options-credentials-2>credentials
          mode</a>, and <a href=webappapis.html#concept-script-fetch-options-referrer-policy id=timers:concept-script-fetch-options-referrer-policy>referrer
          policy</a> is <var>initiating script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options-3>fetch options</a>'s <a href=webappapis.html#concept-script-fetch-options-referrer-policy id=timers:concept-script-fetch-options-referrer-policy-2>referrer policy</a>.</p>

          <p class=note>The effect of these options ensures that the string compilation done by
          <code id=timers:dom-settimeout-6><a href=#dom-settimeout>setTimeout()</a></code> and <code id=timers:dom-setinterval-6><a href=#dom-setinterval>setInterval()</a></code> behaves equivalently to that done by
          <code id=timers:eval()><a data-x-internal=eval() href=https://tc39.es/ecma262/#sec-eval-x>eval()</a></code>. That is, <a id=timers:module-script href=webappapis.html#module-script>module script</a> fetches via <code id=timers:import()><a data-x-internal=import() href=https://tc39.es/ecma262/#sec-import-calls>import()</a></code>
          will behave the same in both contexts.</p>
         <li><p>Let <var>script</var> be the result of <a id=timers:creating-a-classic-script href=webappapis.html#creating-a-classic-script>creating a classic script</a> given
         <var>script source</var>, <var>settings object</var>, <var>base URL</var>, and <var>fetch
         options</var>.<li><p><a href=webappapis.html#run-a-classic-script id=timers:run-a-classic-script>Run the classic script</a>
         <var>script</var>.</ol>
       </dl>
     <li><p>If the <var>repeat</var> flag is true, then call <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps-3>timer initialization
     steps</a> again, passing them the same method arguments, the same <var>method
     context</var>, with the <var>repeat</var> flag still set to true, and with the <var>previous handle</var> set to <var>handler</var>.</ol>
   <li><p>Let <var>timeout</var> be the second method argument.<li>
    <p>If the currently running <a href=webappapis.html#concept-task id=timers:concept-task-2>task</a> is a task that was created
    by this algorithm, then let <var>nesting level</var> be the <a href=webappapis.html#concept-task id=timers:concept-task-3>task</a>'s <a href=#timer-nesting-level id=timers:timer-nesting-level>timer nesting level</a>. Otherwise, let
    <var>nesting level</var> be zero.</p>

    <p class=note>The task's <a href=#timer-nesting-level id=timers:timer-nesting-level-2>timer nesting level</a> is used both for nested calls to
    <code id=timers:dom-settimeout-7><a href=#dom-settimeout>setTimeout()</a></code>, and for the repeating timers created by <code id=timers:dom-setinterval-7><a href=#dom-setinterval>setInterval()</a></code>. (Or, indeed, for any combination of the two.) In
    other words, it represents nested invocations of this algorithm, not of a particular method.</p>
   <li><p>If <var>timeout</var> is less than 0, then set <var>timeout</var> to 0.<li><p>If <var>nesting level</var> is greater than 5, and <var>timeout</var> is less than 4, then
   set <var>timeout</var> to 4.<li><p>Increment <var>nesting level</var> by one.<li><p>Let <var>task</var>'s <dfn id=timer-nesting-level>timer nesting level</dfn> be <var>nesting
   level</var>.<li><p>Return <var>handle</var>, and then continue running this algorithm
   <a id=timers:in-parallel href=infrastructure.html#in-parallel>in parallel</a>.<li>
    <p>If <var>method context</var> is a <code id=timers:window-3><a href=window-object.html#window>Window</a></code> object, wait until the
    <code id=timers:document><a href=dom.html#document>Document</a></code> associated with <var>method context</var> has been <a id=timers:fully-active href=browsers.html#fully-active>fully
    active</a> for a further <var>timeout</var> milliseconds (not necessarily
    consecutively).</p>

    <p>Otherwise, <var>method context</var> is a <code id=timers:workerglobalscope-4><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object;
    wait until <var>timeout</var> milliseconds have passed with the worker not suspended
    (not necessarily consecutively).</p>
   <li>
    <p>Wait until any invocations of this algorithm that had the same <var>method
    context</var>, that started before this one, and whose <var>timeout</var> is equal to
    or less than this one's, have completed.</p>

    <p class=note>Argument conversion as defined by Web IDL (for example, invoking <code>toString()</code> methods on objects passed as the first argument) happens in the
    algorithms defined in Web IDL, before this algorithm is invoked.</p>

    <div class=example>

     <p>So for example, the following rather silly code will result in the log containing "<code>ONE TWO </code>":</p>

     <pre><code class=js>var log = '';
function logger(s) { log += s + ' '; }

setTimeout({ toString: function () {
  setTimeout("logger('ONE')", 100);
  return "logger('TWO')";
} }, 100);</code></pre>

    </div>
   <li>
    <p>Optionally, wait a further <a id=timers:implementation-defined-2 href=https://infra.spec.whatwg.org/#implementation-defined data-x-internal=implementation-defined>implementation-defined</a> length of time.</p>

    <p class=note>This is intended to allow user agents to pad timeouts as needed to optimize the
    power usage of the device. For example, some processors have a low-power mode where the
    granularity of timers is reduced; on such platforms, user agents can slow timers down to fit
    this schedule instead of requiring the processor to use the more accurate mode with its
    associated higher power usage.</p>
   <li>
    <p><a id=timers:queue-a-global-task href=webappapis.html#queue-a-global-task>Queue a global task</a> on the <dfn id=timer-task-source>timer task source</dfn> given <var>method
    context</var> to run <var>task</var>.</p>

    <p class=note>Once the task has been processed, if the <var>repeat</var> flag is
    false, it is safe to remove the entry for <var>handle</var> from the <a href=#list-of-active-timers id=timers:list-of-active-timers-6>list of
    active timers</a> (there is no way for the entry's existence to be detected past this point,
    so it does not technically matter one way or the other).</p>
   </ol>

  

  <div class=example>

   <p>To run tasks of several milliseconds back to back without any delay, while still yielding back
   to the browser to avoid starving the user interface (and to avoid the browser killing the script
   for hogging the CPU), simply queue the next timer before performing work:</p>

   <pre><code class=js>function doExpensiveWork() {
  var done = false;
  // ...
  // this part of the function takes up to five milliseconds
  // set done to true if we're done
  // ...
  return done;
}

function rescheduleWork() {
  var handle = setTimeout(rescheduleWork, 0); // preschedule next iteration
  if (doExpensiveWork())
    clearTimeout(handle); // clear the timeout if we don't need it
}

function scheduleWork() {
  setTimeout(rescheduleWork, 0);
}

scheduleWork(); // queues a task to do lots of work</code></pre>

  </div>



  <h3 id=microtask-queuing><span class=secno>8.7</span> Microtask queuing<a href=#microtask-queuing class=self-link></a></h3><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask title="The queueMicrotask() method, which is exposed on the Window or Worker interface, queues a microtask to be executed at a safe time prior to control returning to the browser's event loop.">WindowOrWorkerGlobalScope/queueMicrotask</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>69+</span></span><span class="safari yes"><span>Safari</span><span>12.1+</span></span><span class="chrome yes"><span>Chrome</span><span>71+</span></span><hr><span class="opera yes"><span>Opera</span><span>58+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge no"><span>Edge (Legacy)</span><span>No</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>79+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>12.2+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>71+</span></span><span class="webview_android yes"><span>WebView Android</span><span>71+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>10.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>50+</span></span></div></div></div>
<div data-zh-date="" data-en-date="Wed Nov 04 2020 06:47:17 GMT+0000 (UTC)" class=translate-info data-zh-file="https://github.com/whatwg-cn/html/new/master/src/web-application-apis/microtask-queuing.zh.html?filename=microtask-queuing.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fweb-application-apis%2Fmicrotask-queuing.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/web-application-apis/microtask-queuing.en.html></div>

  <dl class=domintro><dt><var>self</var> . <code id=dom-queuemicrotask-dev><a href=#dom-queuemicrotask>queueMicrotask</a></code>(<var>callback</var>)<dd><p><a href=webappapis.html#queue-a-microtask id=microtask-queuing:queue-a-microtask>Queues</a> a <a id=microtask-queuing:microtask href=webappapis.html#microtask>microtask</a> to run the given
   <var>callback</var>.</dl>

  <p>The <dfn id=dom-queuemicrotask><code>queueMicrotask(<var>callback</var>)</code></dfn> method must
  <a id=microtask-queuing:queue-a-microtask-2 href=webappapis.html#queue-a-microtask>queue a microtask</a> to <a href=https://heycam.github.io/webidl/#invoke-a-callback-function id=microtask-queuing:es-invoking-callback-functions data-x-internal=es-invoking-callback-functions>invoke</a>
  <var>callback</var>, and if <var>callback</var> throws an exception, <a id=microtask-queuing:report-the-exception href=webappapis.html#report-the-exception>report the
  exception</a>.</p>

  <p>The <code id=microtask-queuing:dom-queuemicrotask><a href=#dom-queuemicrotask>queueMicrotask()</a></code> method allows authors to schedule
  a callback on the <a id=microtask-queuing:microtask-queue href=webappapis.html#microtask-queue>microtask queue</a>. This allows their code to run after the
  currently-executing <a href=webappapis.html#concept-task id=microtask-queuing:concept-task>task</a> has run to completion and the
  <a id=microtask-queuing:javascript-execution-context-stack href=https://tc39.es/ecma262/#execution-context-stack data-x-internal=javascript-execution-context-stack>JavaScript execution context stack</a> is empty, but without yielding control back to the
  <a id=microtask-queuing:event-loop href=webappapis.html#event-loop>event loop</a>, as would be the case when using, for example, <code id=microtask-queuing:dom-settimeout><a href=#dom-settimeout>setTimeout(<var>f</var>, 0)</a></code>.</p>

  <p>Authors ought to be aware that scheduling a lot of microtasks has the same performance
  downsides as running a lot of synchronous code. Both will prevent the browser from doing its own
  work, such as rendering or scrolling. In many cases, <code id=microtask-queuing:dom-animationframeprovider-requestanimationframe><a href=imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe>requestAnimationFrame()</a></code> or
  <code id=microtask-queuing:requestidlecallback()><a data-x-internal=requestidlecallback() href=https://w3c.github.io/requestidlecallback/#the-requestidlecallback-method>requestIdleCallback()</a></code> is a better choice. In particular, if the goal is to run code
  before the next rendering cycle, that is the purpose of <code id=microtask-queuing:dom-animationframeprovider-requestanimationframe-2><a href=imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe>requestAnimationFrame()</a></code>.</p>

  <p>As can be seen from the following examples, the best way of thinking about <code id=microtask-queuing:dom-queuemicrotask-2><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is as a mechanism for rearranging synchronous
  code, effectively placing the queued code immediately after the current task's worth of non-queued
  JavaScript.</p>

  <div class=example>
   <p>The most common reason for using <code id=microtask-queuing:dom-queuemicrotask-3><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is
   to create consistent ordering, even in the cases where information is available synchronously,
   without introducing undue delay.</p>

   <p>For example, consider a custom element firing a <code>load</code> event, that also
   maintains an internal cache of previously-loaded data. A naïve implementation might look
   like:</p>

   <pre><code class=js>MyElement.prototype.loadData = function (url) {
  if (this._cache[url]) {
    this._setData(this._cache[url]);
    this.dispatchEvent(new Event("load"));
  } else {
    fetch(url).then(res => res.arrayBuffer()).then(data => {
      this._cache[url] = data;
      this._setData(data);
      this.dispatchEvent(new Event("load"));
    });
  }
};</code></pre>

   <p>This naïve implementation is problematic, however, in that it causes its users to
   experience inconsistent behavior. For example, code such as</p>

   <pre><code class=js>element.addEventListener("load", () => console.log("loaded"));
console.log("1");
element.loadData();
console.log("2");</code></pre>

   <p>will sometimes log "1, 2, loaded" (if the data needs to be fetched), and sometimes log "1,
   loaded, 2" (if the data is already cached). Similarly, after the call to <code>loadData()</code>, it will be inconsistent whether or not the data is set on the
   element.</p>

   <p>To get a consistent ordering, <code id=microtask-queuing:dom-queuemicrotask-4><a href=#dom-queuemicrotask>queueMicrotask()</a></code> can be
   used:</p>

   <pre><code class=js>MyElement.prototype.loadData = function (url) {
  if (this._cache[url]) {<strong>
    queueMicrotask(() => {
      this._setData(this._cache[url]);
      this.dispatchEvent(new Event("load"));
    });</strong>
  } else {
    fetch(url).then(res => res.arrayBuffer()).then(data => {
      this._cache[url] = data;
      this._setData(data);
      this.dispatchEvent(new Event("load"));
    });
  }
};</code></pre>

   <p>By essentially rearranging the queued code to be after the currently-executing task, this
   ensures a consistent ordering and update of the element's state.</p>
  </div>

  <div class=example>
   <p>Another interesting use of <code id=microtask-queuing:dom-queuemicrotask-5><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is to
   allow uncoordinated "batching" of work by multiple callers. For example, consider a library
   function that wants to send data somewhere as soon as possible, but doesn't want to make multiple
   network requests if doing so is easily avoidable. One way to balance this would be like so:</p>

   <pre><code class=js>const queuedToSend = [];

function sendData(data) {
  queuedToSend.push(data);

  if (queuedToSend.length === 1) {
    queueMicrotask(() => {
      const stringToSend = JSON.stringify(queuedToSend);
      queuedToSend.length = 0;

      fetch("/endpoint", stringToSend);
    });
  }
}</code></pre>

   <p>With this architecture, multiple subsequent calls to <code>sendData()</code> within
   the same turn of the event loop will be batched together into one <code id=microtask-queuing:fetch()><a data-x-internal=fetch() href=https://fetch.spec.whatwg.org/#dom-global-fetch>fetch()</a></code> call, but
   with no intervening event loop tasks preempting the fetch (as would have happened with similar
   code that instead used <code id=microtask-queuing:dom-settimeout-2><a href=#dom-settimeout>setTimeout()</a></code>).</p>
  </div>



  <h3 id=用户提示><span class=secno>8.8</span> 用户提示<a href=#用户提示 class=self-link></a></h3>
<div data-zh-date="Thu Mar 01 2018 15:51:30 GMT+0000 (UTC)" data-en-date="Thu Mar 01 2018 15:51:30 GMT+0000 (UTC)" class=translate-info data-zh-file=https://github.com/whatwg-cn/html/edit/master/src/web-application-apis/user-prompts/index.zh.html data-en-file=https://github.com/whatwg-cn/html/blob/master/src/web-application-apis/user-prompts/index.en.html></div>

  


  <h4 id=simple-dialogs><span class=secno>8.8.1</span> Simple dialogs<a href=#simple-dialogs class=self-link></a></h4>
<div data-zh-date="" data-en-date="Wed Nov 04 2020 06:47:17 GMT+0000 (UTC)" class=translate-info data-zh-file="https://github.com/whatwg-cn/html/new/master/src/web-application-apis/user-prompts/simple-dialogs.zh.html?filename=simple-dialogs.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fweb-application-apis%2Fuser-prompts%2Fsimple-dialogs.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/web-application-apis/user-prompts/simple-dialogs.en.html></div>

  <dl class=domintro><dt><var>window</var> . <code id=dom-alert-dev><a href=#dom-alert>alert</a></code>(<var>message</var>)<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/alert title="window.alert() instructs the browser to display a dialog with an optional message, and to wait until the user dismisses the dialog.">Window/alert</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Displays a modal alert with the given message, and waits for the user to dismiss it.</p>
   <dt><var>result</var> = <var>window</var> . <code id=dom-confirm-dev><a href=#dom-confirm>confirm</a></code>(<var>message</var>)<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/confirm title="window.confirm() instructs the browser to display a dialog with an optional message, and to wait until the user either confirms or cancels the dialog.">Window/confirm</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Displays a modal OK/Cancel prompt with the given message, waits for the user to dismiss it,
    and returns true if the user clicks OK and false if the user clicks Cancel.</p>
   <dt><var>result</var> = <var>window</var> . <code id=dom-prompt-dev><a href=#dom-prompt>prompt</a></code>(<var>message</var> [, <var>default</var>] )<div class="mdn-anno wrapped before"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/prompt title="window.prompt() instructs the browser to display a dialog with an optional message prompting the user to input some text, and to wait until the user either submits the text or cancels the dialog.">Window/prompt</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd>
    <p>Displays a modal text control prompt with the given message, waits for the user to dismiss
    it, and returns the value that the user entered. If the user cancels the prompt, then returns
    null instead. If the second argument is present, then the given value is used as a default.</p>
   </dl>

  <p class=note>Logic that depends on <a href=webappapis.html#concept-task id=simple-dialogs:concept-task>tasks</a> or <a href=webappapis.html#microtask id=simple-dialogs:microtask>microtasks</a>, such as <a href=media.html#media-element id=simple-dialogs:media-element>media elements</a>
  loading their <a id=simple-dialogs:media-data href=media.html#media-data>media data</a>, are stalled when these methods are invoked.</p>

  

  <p>To <dfn id=optionally-truncate-a-simple-dialog-string>optionally truncate a simple dialog string</dfn> <var>s</var>, return either
  <var>s</var> itself or some string derived from <var>s</var> that is shorter. User agents should
  not provide UI for displaying the elided portion of <var>s</var>, as this makes it too easy for
  abusers to create dialogs of the form "Important security alert! Click 'Show More' for full
  details!".</p>

  <p class=note>For example, a user agent might want to only display the first 100 characters of a
  message. Or, a user agent might replace the middle of the string with "…". These types of
  modifications can be useful in limiting the abuse potential of unnaturally large,
  trustworthy-looking system dialogs.</p>

  <p>The <dfn data-dfn-for=Window id=dom-alert data-dfn-type=method><code>alert(<var>message</var>)</code></dfn>
  method, when invoked, must run the following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return.<li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.<li><p>Optionally, return. (For example, the user agent might give the user the option
   to ignore all alerts, and would thus abort at this step whenever the method was
   invoked.)<li><p>If the method was invoked with no arguments, then let <var>message</var> be the
   empty string; otherwise, let <var>message</var> be the method's first
   argument.<li><p>Set <var>message</var> to the result of <a href=https://infra.spec.whatwg.org/#normalize-newlines id=simple-dialogs:normalize-newlines data-x-internal=normalize-newlines>normalizing
   newlines</a> given <var>message</var>.<li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string>optionally truncating</a> <var>message</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break.<li><p>Optionally, <a id=simple-dialogs:pause href=webappapis.html#pause>pause</a> while waiting for the user to acknowledge the
   message.</ol>

  <p>The <dfn data-dfn-for=Window id=dom-confirm data-dfn-type=method><code>confirm(<var>message</var>)</code></dfn> method, when invoked, must run the
  following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop-2 href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level-2 href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return false.<li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set-2 href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window-2><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window-2>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag-2 href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.<li><p>Optionally, return false. (For example, the user agent might give
   the user the option to ignore all prompts, and would thus abort at this step whenever the method
   was invoked.)<li><p>Set <var>message</var> to the result of <a href=https://infra.spec.whatwg.org/#normalize-newlines id=simple-dialogs:normalize-newlines-2 data-x-internal=normalize-newlines>normalizing
   newlines</a> given <var>message</var>.<li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-2>optionally truncating</a> <var>message</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break, and ask the user
   to respond with a positive or negative response.<li><p><a id=simple-dialogs:pause-2 href=webappapis.html#pause>Pause</a> until the user responds either positively or negatively.<li><p>If the user responded positively, return true; otherwise, the user responded negatively:
   return false.</ol>

  <p>The <dfn data-dfn-for=Window id=dom-prompt data-dfn-type=method><code>prompt(<var>message</var>,
  <var>default</var>)</code></dfn> method, when invoked, must run the following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop-3 href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level-3 href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return null.<li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set-3 href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window-3><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window-3>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag-3 href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.<li><p>Optionally, return null. (For example, the user agent might give the
   user the option to ignore all prompts, and would thus abort at this step whenever the method was
   invoked.)<li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-3>optionally truncating</a> <var>message</var>.<li><p>Set <var>message</var> to the result of <a href=https://infra.spec.whatwg.org/#normalize-newlines id=simple-dialogs:normalize-newlines-3 data-x-internal=normalize-newlines>normalizing
   newlines</a> given <var>message</var>.<li><p>Set <var>default</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-4>optionally truncating</a> <var>default</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break, and ask the user
   to either respond with a string value or abort. The response must be defaulted to the value given
   by <var>default</var>.<li><p><a id=simple-dialogs:pause-3 href=webappapis.html#pause>Pause</a> while waiting for the user's response.<li><p>If the user aborts, then return null; otherwise, return the string that the user responded
   with.</ol>

  



  <h4 id=printing><span class=secno>8.8.2</span> Printing<a href=#printing class=self-link></a></h4><div class="mdn-anno wrapped"><button onclick=toggleStatus(this) class=mdn-anno-btn><b title="Support in all current engines." class=all-engines-flag>✔</b><span>MDN</span></button><div class=feature><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/print title="Opens the Print Dialog to print the current document.">Window/print</a><p class=all-engines-text>Support in all current engines.<div class=support><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1.1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>5+</span></span><hr><span class="firefox_android no"><span>Firefox Android</span><span>No</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div>
<div data-zh-date="" data-en-date="Wed Nov 04 2020 06:47:17 GMT+0000 (UTC)" class=translate-info data-zh-file="https://github.com/whatwg-cn/html/new/master/src/web-application-apis/user-prompts/printing.zh.html?filename=printing.zh.html&amp;value=%E4%BB%8E%20https%3A%2F%2Fgithub.com%2Fwhatwg-cn%2Fhtml%2Fblob%2Fmaster%2Fsrc%2Fweb-application-apis%2Fuser-prompts%2Fprinting.en.html%20%E6%8B%B7%E8%B4%9D%E8%8B%B1%E6%96%87%E6%BA%90%E7%A0%81%E8%87%B3%E6%AD%A4%EF%BC%8C%E5%BC%80%E5%A7%8B%E7%BF%BB%E8%AF%91" data-en-file=https://github.com/whatwg-cn/html/blob/master/src/web-application-apis/user-prompts/printing.en.html></div>

  <dl class=domintro><dt><var>window</var> . <code id=dom-print-dev><a href=#dom-print>print</a></code>()<dd>
    <p>Prompts the user to print the page.</p>
   </dl>

  

  <p>When the <dfn data-dfn-for=Window id=dom-print data-dfn-type=method><code>print()</code></dfn> method is
  invoked, if the <code id=printing:document><a href=dom.html#document>Document</a></code> is <a id=printing:ready-for-post-load-tasks href=parsing.html#ready-for-post-load-tasks>ready for post-load tasks</a>, then the user
  agent must run the <a href=#printing-steps id=printing:printing-steps>printing steps</a>. Otherwise, the user agent must only set the
  <dfn id=print-when-loaded>print when loaded</dfn> flag on the <code id=printing:document-2><a href=dom.html#document>Document</a></code>.</p>


  <p>User agents should also run the <a href=#printing-steps id=printing:printing-steps-2>printing steps</a> whenever the user asks for the
  opportunity to <a id=printing:obtain-a-physical-form href=rendering.html#obtain-a-physical-form>obtain a physical form</a> (e.g. printed copy), or the representation of a
  physical form (e.g. PDF copy), of a document.</p>

  <p>The <dfn id=printing-steps>printing steps</dfn> are as follows:</p>

  <ol><li>
    <p>The user agent may display a message to the user or return (or both).</p>

    <p class=example>For instance, a kiosk browser could silently ignore any invocations of the
    <code id=printing:dom-print><a href=#dom-print>print()</a></code> method.</p>

    <p class=example>For instance, a browser on a mobile device could detect that there are no
    printers in the vicinity and display a message saying so before continuing to offer a "save to
    PDF" option.</p>
   <li>
    <p>If the <a id=printing:active-sandboxing-flag-set href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=printing:window><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=printing:concept-document-window>associated <code>Document</code></a> has the <a id=printing:sandboxed-modals-flag href=origin.html#sandboxed-modals-flag>sandboxed
    modals flag</a> set, then return.</p>

    <p class=note>If the printing dialog is blocked by a <code id=printing:document-3><a href=dom.html#document>Document</a></code>'s sandbox,
    then neither the <code id=printing:event-beforeprint><a href=indices.html#event-beforeprint>beforeprint</a></code> nor <code id=printing:event-afterprint><a href=indices.html#event-afterprint>afterprint</a></code> events will be fired.</p>
   <li>
    <p>The user agent must <a href=https://dom.spec.whatwg.org/#concept-event-fire id=printing:concept-event-fire data-x-internal=concept-event-fire>fire an event</a> named <code id=printing:event-beforeprint-2><a href=indices.html#event-beforeprint>beforeprint</a></code> at the <a id=printing:concept-relevant-global href=webappapis.html#concept-relevant-global>relevant global object</a> of the
    <code id=printing:document-4><a href=dom.html#document>Document</a></code> that is being printed, as well as any <a href=browsers.html#child-browsing-context id=printing:child-browsing-context>child browsing contexts</a> in it.</p>

    <p class=example>The <code id=printing:event-beforeprint-3><a href=indices.html#event-beforeprint>beforeprint</a></code> event can be used to
    annotate the printed copy, for instance adding the time at which the document was printed.</p>
   <li>
    <p>The user agent should offer the user the opportunity to <a id=printing:obtain-a-physical-form-2 href=rendering.html#obtain-a-physical-form>obtain a physical form</a>
    (or the representation of a physical form) of the document. The user agent may wait for the user
    to either accept or decline before returning; if so, the user agent must <a id=printing:pause href=webappapis.html#pause>pause</a>
    while the method is waiting. Even if the user agent doesn't wait at this point, the user agent
    must use the state of the relevant documents as they are at this point in the algorithm if and
    when it eventually creates the alternate form.</p>
   <li>
    <p>The user agent must <a href=https://dom.spec.whatwg.org/#concept-event-fire id=printing:concept-event-fire-2 data-x-internal=concept-event-fire>fire an event</a> named <code id=printing:event-afterprint-2><a href=indices.html#event-afterprint>afterprint</a></code> at the <a id=printing:concept-relevant-global-2 href=webappapis.html#concept-relevant-global>relevant global object</a> of the
    <code id=printing:document-5><a href=dom.html#document>Document</a></code> that is being printed, as well as any <a href=browsers.html#child-browsing-context id=printing:child-browsing-context-2>child browsing contexts</a> in it.</p>

    <p class=example>The <code id=printing:event-afterprint-3><a href=indices.html#event-afterprint>afterprint</a></code> event can be used to
    revert annotations added in the earlier event, as well as showing post-printing UI. For
    instance, if a page is walking the user through the steps of applying for a home loan, the
    script could automatically advance to the next step after having printed a form or other.</p>
   </ol>

  



  <nav><a href=dynamic-markup-insertion.html>← 8.4 Dynamic markup insertion</a> — <a href=./>Table of Contents</a> — <a href=system-state.html>8.9 System state and capabilities →</a></nav>
<script src=/html/resources/zh-cn.js></script>
