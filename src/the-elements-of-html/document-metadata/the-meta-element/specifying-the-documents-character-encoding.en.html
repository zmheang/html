  <h5 id="charset">Specifying the document's character encoding</h5>

  <!-- READ ME WHEN EDITING: if we ever move this to the "writing HTML" section, then we have to
  duplicate the requirements in the parsing section for conformance checkers, and we have to make
  sure that the requirements for charset="" apply even in XML, for the <meta charset=""> polyglot
  hack. -->

  <p>A <dfn>character encoding declaration</dfn> is a mechanism by which the <span
  data-x="encoding">character encoding</span> used to store or transmit a document is specified.</p>

  <p>The Encoding standard requires use of the <span>UTF-8</span> <span data-x="encoding">character
  encoding</span> and requires use of the "<code data-x="">utf-8</code>" <span>encoding label</span>
  to identify it. Those requirements necessitate that the document's <span>character encoding
  declaration</span>, if it exists, specifies an <span>encoding label</span> using an <span>ASCII
  case-insensitive</span> match for "<code data-x="">utf-8</code>". Regardless of whether a
  <span>character encoding declaration</span> is present or not, the actual <span data-x="document's
  character encoding">character encoding</span> used to encode the document must be
  <span>UTF-8</span>. <ref spec=ENCODING></p>

  <p w-nodev>To enforce the above rules, authoring tools must default to using <span>UTF-8</span>
  for newly-created documents.</p>

  <p>The following restrictions also apply:</p>

  <ul>
   <li>The character encoding declaration must be serialized without the use of <span
   data-x="syntax-charref">character references</span> or character escapes of any kind.</li>

   <li id="charset1024"><span data-x="" id="charset512">The element containing the character encoding
   declaration must be serialized completely within the first 1024 bytes of the
   document.</span></li> <!-- span is for historical reasons, to keep an old ID alive -->
  </ul>

  <p>In addition, due to a number of restrictions on <code>meta</code> elements, there can only be
  one <code>meta</code>-based character encoding declaration per document.</p> <!-- conformance
  criteria for this one are given in the XML spec, the <meta> section just after defining
  charset="", and the character encoding pragma section. Note that you _can_ have two character
  encoding declarations per document, if the document is an XML document and one is an XML
  declaration, the other is <meta charset>, and the encoding is UTF-8. -->

  <p>If an <span data-x="HTML documents">HTML document</span> does not start with a BOM, and its
  <span>encoding</span> is not explicitly given by <span data-x="Content-Type">Content-Type
  metadata</span>, and the document is not <span>an <code>iframe</code> <code
  data-x="attr-iframe-srcdoc">srcdoc</code> document</span>, then the encoding must be specified
  using a <code>meta</code> element with a <code data-x="attr-meta-charset">charset</code> attribute
  or a <code>meta</code> element with an <code data-x="attr-meta-http-equiv">http-equiv</code>
  attribute in the <span data-x="attr-meta-http-equiv-content-type">Encoding declaration
  state</span>.</p>

  <div class="note">
   <p>A character encoding declaration is required (either in the <span
   data-x="Content-Type">Content-Type metadata</span> or explicitly in the file) even when all
   characters are in the ASCII range, because a character encoding is needed to process non-ASCII
   characters entered by the user in forms, in URLs generated by scripts, and so forth.</p>

   <p>Using non-UTF-8 encodings can have unexpected results on form submission and URL encodings,
   which use the <span>document's character encoding</span> by default.</p>
  </div>

  <p>If the document is <span>an <code>iframe</code> <code data-x="attr-iframe-srcdoc">srcdoc</code>
  document</span>, the document must not have a <span>character encoding declaration</span>. (In
  this case, the source is already decoded, since it is part of the document that contained the
  <code>iframe</code>.)</p>

  <p>In XML, the XML declaration should be used for inline character encoding information, if
  necessary.</p>

  <div class="example">

   <p>In HTML, to declare that the character encoding is <span>UTF-8</span>, the author could
   include the following markup near the top of the document (in the <code>head</code> element):</p>

   <pre><code class="html">&lt;meta charset="utf-8"></code></pre>

   <p>In XML, the XML declaration would be used instead, at the very top of the markup:</p>

   <pre><code class="html">&lt;?xml version="1.0" encoding="utf-8"?></code></pre>

  </div>



